(()=>{"use strict";if(window.addEventListener("message",async e=>{if("https://deepsight.vercel.app"!==e.origin)return;const{type:n,payload:t}=e.data||{};if("DEEPSIGHT_AUTH_SUCCESS"===n){console.log("[DeepSight Extension] Received auth from website");try{const e=await chrome.runtime.sendMessage({action:"SYNC_AUTH_FROM_WEBSITE",data:t});e?.success&&(console.log("[DeepSight Extension] Auth synced successfully"),window.postMessage({type:"DEEPSIGHT_EXTENSION_AUTH_SYNCED"},"*"))}catch(e){console.error("[DeepSight Extension] Failed to sync auth:",e)}}}),"true"===new URL(window.location.href).searchParams.get("extension")){console.log("[DeepSight Extension] Running on DeepSight website in extension mode");const e=document.createElement("script");e.textContent="\n    window.__DEEPSIGHT_EXTENSION_PRESENT__ = true;\n  ",document.documentElement.appendChild(e),e.remove()}async function e(){await new Promise(e=>setTimeout(e,2e3));const e=document.createElement("script");e.textContent="\n    (function() {\n      try {\n        const accessToken = localStorage.getItem('accessToken');\n        const refreshToken = localStorage.getItem('refreshToken');\n        const userStr = localStorage.getItem('user');\n        \n        if (accessToken && refreshToken && userStr) {\n          window.postMessage({\n            type: 'DEEPSIGHT_AUTH_SUCCESS',\n            payload: {\n              accessToken,\n              refreshToken,\n              user: JSON.parse(userStr)\n            }\n          }, '*');\n        }\n      } catch (e) {\n        console.error('[DeepSight] Failed to read localStorage:', e);\n      }\n    })();\n  ",document.documentElement.appendChild(e),e.remove()}"loading"===document.readyState?document.addEventListener("DOMContentLoaded",e):e(),console.log("[DeepSight Extension] Auth sync script loaded")})();